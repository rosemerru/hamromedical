/* repo: newsletter/release-gdpr-updates-1.0@1.9.0-0-g233115b - Package Version: 1.9.0 - 2018-05-24 05:02 pm - User:  */
define(["newsletter/1/service"],function(e){function t(){return{uiMode:"harmony-right",isHover:!1,isCenter:!1,selector:"#moduleID",nl:36,template:{privacyStatementDaily:'By clicking "Subscribe," I agree to the WebMD <a href="https://www'+webmd.url.getLifecycle()+'.webmd.com/about-webmd-policies/about-terms-and-conditions-of-use" class="newsletter-terms" target="_blank">Terms and Conditions</a> and <a href="https://www'+webmd.url.getLifecycle()+'.webmd.com/about-webmd-policies/about-privacy-policy" class="newsletter-privacy" target="_blank">Privacy Policy</a>. I also agree to receive emails from WebMD and I understand that I may opt out of WebMD subscriptions at any time.',content:'{logo}\n<div class="nls-header">{header}</div>\n{preContent}<div class="nls-content">\n{preForm}<form class="nls-form" action="#" novalidate="novalidate">\n<div class="validationWrapper"><div class="checkbox-container clearfix">{inputs}</div></div>\n{midForm}<div class="input-container">\n<div class="email-container validationWrapper">\n<input type="email" class="nls-email" name="email" autocapitalize="off" autocorrect="off" placeholder="Enter your email address" /> <button name="nl-submit" formnovalidate class="off {submitClass}" type="submit"><span>Subscribe</span></button>\n<div class="clearfix"></div></div>\n{postEmailContainer}</div>\n</form>\n{postForm}</div>\n{postContent}',logo:'<img src="'+image_server_url+'/webmd/consumer_assets/site_images/masthead2015/logo-webmd-site.png" class="newsletter-daily-logo" alt="WebMD: Better information. Better health." title="WebMD: Better information. Better health."></a>',inputSingle:'<input type="hidden" name="nls" value="{id}">',inputMulti:'<label><input type="checkbox" name="nls" class="multi-checkbox" value="{id}">{title}</label>',inputMultiHarmony:'<div class="clearfix"><span>{title}</span><input id="{eleId}" type="checkbox" name="nls" class="multi-checkbox" value="{id}"><label for="{eleId}"> </label></div>',downtime:"<p>This feature is currently unavailable. The site is undergoing routine maintenance and will be back shortly.</p>",loading:'<div class="loading"><div class="loading_medium_png"><span>Loading...</span></div></div>',successHeader:"<h2>Thank You.</h2>",failure:'<div class="failure"><p>This feature is temporarily unavailable.</p><p>Please visit our <a href="{url}">Newsletter Preference Center</a> for all of our available subscription offerings.</p>',readonly:'<div class="failure"><p>This feature is temporarily unavailable.</p><p>Please try again later.</p>',submitClass:"",successViewContent:'<div class="success-msg"><h2>Thank you for subscribing to the<br />{newsletterNames}</h2><p>{email}</p></div><div class="webmd-rb-promo-driver"><header><h3>Cold &amp; Flu Activity</h3></header><span class="map-driver-main-text">Are colds and flu on the rise near you?</span><a class="map-driver-action-text" href="//symptoms.webmd.com/cold-flu-map/default.htm" data-metrics-module="nl-hov" data-metrics-link="promo">Check the activity in your area</a></div>',checkBox2ColWrapper:"<div>{col1}</div><div>{col2}</div>"},metricsModule:"nl-hov_suc",metricsModuleExist:"nl-hov_e3",metricsModuleMultiple:"nl-multie",newsletterUrl:webmd.substitute("https://member{env}.webmd.com/newsletters/newsletters.aspx",{env:webmd.url.getEnv()}),init:function(e){var t;return t=this,e=e||{},$.extend(!0,t,e),t.el=$(t.selector),t.multiple=$.isArray(t.nl),t.isHover=e.uiMode&&e.uiMode.indexOf("-hover")>-1,t.isCenter=e.uiMode&&e.uiMode.indexOf("-center")>-1,1==t.isHover?t.metricsModuleMultiple="nl-hov":1==t.isCenter&&(t.metricsModuleMultiple="nl-cmultie"),t.buildModule(),t.vendor=webmd.url.getParam("vendor")||"",t.publisher=webmd.url.getParam("publisher")||"",t.campaign=webmd.url.getParam("campaign")||"",webmd.isDown("reg")?(t.showDowntime(),void 0):($(".nls-content").on("click","a",function(){$(this).hasClass("newsletter-terms")&&wmdPageLink("nl-hov_tc"),$(this).hasClass("newsletter-privacy")&&wmdPageLink("nl-hov_pp"),$(this).hasClass("newsletter-subscribe")&&(wmdPageLink("nl-hov_morenl"),$("#webmdHoverWrapper").removeClass("newsletter-hover"),$("#webmdHoverOverlay").removeClass("newsletter-hover"),webmd.overlay.close())}),$("#webmdHoverClose").one("click",function(){$("#colorbox").removeClass("hoverTopStyle"),$("#webmdHoverWrapper").removeClass("newsletter-hover"),$("#webmdHoverOverlay").removeClass("newsletter-hover"),wmdPageLink("nl-hov_x")}),t.initEvents(),$(window).trigger("nlOverlayOpen"),void 0)},buildModule:function(){var e,t,i,n,s,a,o;s=this,t=s.el,n="",a="_"+s.selector.replace(/\#/g,"").replace(/ /g,"");var r={1:[11,12,16,17,19,21,22,24,25,26,28,29,30,31,35,37,40,42,43,44,45,61,63,66,74,84,97],2:[13,14,18,27,60,882],3:[77,78],4:[83],5:[36]},d=[{header:"<h2>Want to live your best life?</h2>",subhead:'<span class="sub-head">Get our {title} newsletter for health tips, wellness updates and more.</span>'},{header:"<h2>Subscribe to our {title} Newsletter</h2>",subhead:'<span class="sub-head">Heath tips, news, wellness updates and more.</span>'},{header:"<h2>Subscribe to our {title} Newsletter</h2>",subhead:'<span class="sub-head">Keep your pets healthy with tips, news, wellness updates and more.</span>'},{header:"<h2>Want to live your best life?</h2>",subhead:'<span class="sub-head">Get our {title} newsletter for recipes from our Healthy Recipe Finder.</span>'},{header:"<h2>Want to live your best life?</h2>",subhead:'<span class="sub-head">Get the {title} newsletter for health tips, wellness updates and more.</span>'}];$.each(r,function(e){if(-1!=r[e].indexOf(s.nl)){var e=e-1;s.template.header=d[e].header,s.template.subhead=d[e].subhead,i=webmd.substitute(s.template.header,{title:s.getNewsletterTitle(s.nl)},!0),s.template.preForm=webmd.substitute(s.template.subhead,{title:s.getNewsletterTitle(s.nl)},!0)}}),s.template.postEmailContainer='<div class="agreement" data-metrics-module="nl-nonsignup">'+s.template.privacyStatementDaily+"</div>",n=webmd.substitute(s.template.inputSingle,{id:s.getNewsletterId(s.nl),title:s.getNewsletterTitle(s.nl)},!0),e=webmd.substitute(s.template.content,{logo:s.template.logo,header:i,inputs:n,preForm:s.template.preForm,midForm:s.template.midForm,postForm:s.template.postForm,preContent:s.template.preContent,postContent:s.template.postContent,submitClass:s.template.submitClass,postEmailContainer:s.template.postEmailContainer},!0),t.html(e),s.dom={heading:t.find(".nls-header"),content:t.find(".nls-content"),form:t.find(".nls-form"),inputContainer:t.find(".input-container"),privacyDisclaimer:t.find(".privacy-disclaimer"),checkboxContainer:t.find(".checkbox-container"),inputEmail:t.find("input[name=email]"),inputNlId:t.find("input[type=hidden][name=nls]"),inputCheckboxes:t.find("input:checkbox[name=nls]"),button:t.find("button[name=nl-submit]")},setTimeout(function(){o=$.trim(s.dom.inputEmail.val()),!o&&$("#webmdHoverWrapper.newsletter-hover").length&&($(".newsletter-daily").length&&wmdPageLink("nl-hov_col"),$("#webmdHoverWrapper").removeClass("newsletter-hover"),$("#webmdHoverOverlay").removeClass("newsletter-hover"),$("#colorbox").removeClass("hoverTopStyle"),webmd.overlay.close())},3e4),s.resize()},initEvents:function(){var e;e=this,e.dom.form.on("submit",function(t){t.preventDefault(),e.submit()}),e.dom.inputCheckboxes.on("change",function(){e.newsletterCheckboxesChangeHandler()})},validateForm:function(){var e=this,t=e.dom.inputEmail.val(),i=/^[A-Z0-9._%+-]+@[A-Z0-9.-]+\.[A-Z]{2,4}$/i;return e.dom.inputCheckboxes.filter(":checked"),!t||0>=t.length?(wmdPageLink("nl-hov_e1"),alert("You must provide a valid email address."),e.dom.inputEmail.focus(),!1):t.length>200||!i.test(t)?(wmdPageLink("nl-hov_e2"),alert("You must provide a valid email address."),e.dom.inputEmail.focus(),!1):!0},newsletterCheckboxesChangeHandler:function(){for(var e=this,t=!1,i=e.dom.inputCheckboxes,n=0;i.length>n;n++)if($(i[n]).is(":checked")){t=!0;break}1==e.isHover?1==t?e.dom.button.removeClass("off"):e.dom.button.addClass("off"):1==t?e.dom.inputContainer.slideDown():e.dom.inputContainer.slideUp()},submit:function(){var t,i,n;n=this,n.validateForm()&&(t=n.dom.inputEmail.val(),n.email=t,i=window.nlArray?window.nlArray.concat(n.getSelectedNewsletters()):n.getSelectedNewsletters(),n.dom.content.html(n.template.loading),-1>=window.location.protocol.indexOf("https:")&&e.urlSubscribe.indexOf("https:")>-1&&(e.urlSubscribe=e.urlSubscribe.replace("https:","http:")),e.subscribe({email:t,privacy:!0,vendor:n.vendor,publisher:n.publisher,campaign:n.campaign,id:i}).done(function(e){var s;n.multiple?(s=n.metricsModuleMultiple,s+="_"+i.length+"-"+n.nl.length,wmdPageLink(s)):3===e.code?wmdPageLink(n.metricsModule):1===e.code&&wmdPageLink(n.metricsModuleExist),n.usertype=webmd.object.get("d.usertype",e),n.el.removeClass("error").addClass("confirmed"),n.dom.privacyDisclaimer.hide(),n.buildHarmonySuccessView(t,i),$(window).trigger("nlSuccessView")}).fail(function(e,t){"readonly"===t?n.dom.content.html(n.template.readonly):n.dom.content.html(webmd.substitute(n.template.failure,{url:n.newsletterUrl})),n.resize()}))},buildHarmonySuccessView:function(e,t){var i,n=this,s={1004:{imgUrl:"//img.webmd.com/dtmcms/live/webmd/consumer_assets/site_images/articles/health_tools/gourmet_calcium_slideshow/age_rf_photo_of_pizza.jpg?resize=110:75",header:"Weight Loss  &amp; Diet",title:"Body &amp; BMI Calculator",link:"https://www.webmd.com/diet/body-bmi-calculator"},745:{imgUrl:"//img.webmd.com/dtmcms/live/webmd/consumer_assets/site_images/article_thumbnails/other/food_and_fitness_planner_20_other/493x335_food_and_fitness_planner_20_other.jpg?resize=110:75",header:"Food &amp; Recipes",title:"Healthy Recipe Finder",link:"https://www.webmd.com/food-recipes/healthy-recipe-finder"},960:{imgUrl:"//img.webmd.com/dtmcms/live/webmd/consumer_assets/site_images/article_thumbnails/other/sleep_tracker_tool_other/493x335_sleep_tracker_tool_other.jpg?resize=110:75",header:"Fitness &amp; Exercise",title:"Food &amp; Fitness Planner",link:"https://www.webmd.com/diet/food-fitness-planner/default.htm"}},a=window.center_id,o=function(){var e=" WebMD newsletter(s)";if(t&&1==t.length)e=" "+n.getNewsletterTitle(t[0])+" Newsletter";else if(t&&t.length>1){e=" ";for(var i=0;t.length>i;i++)i>0&&i==t.length-1?e+=" and ":i>0&&(e+=", "),e+=n.getNewsletterTitle(t[i]),i==t.length-1&&(e+=" newsletters")}return e};a||(a="960"),i=s[""+a],i||(i=s["960"]),n.dom.heading.hide(),n.dom.content.html(webmd.substitute(n.template.successViewContent,{email:e,newsletterNames:o(),memberSvcUrl:n.newsletterUrl})),$(".webmd-rb-promo-driver").appendTo("#webmdHoverLoadedContent"),require(["webmd.localConditions/1/webmd.localConditions"],function(e){e.init().then(function(e){e&&($(".map-driver-main-text").html(e),$(".map-driver-action-text").html("What about your area?"))}),webmd.overlay.resize()})},showDowntime:function(){var e;webmd.debug("Registration is down."),e=this,e.dom.content.addClass("downtime").html(e.template.downtime),e.resize()},resizeEvent:"newsletterResize",resize:function(){this.el.trigger(this.resizeEvent)},getNewsletterTitle:function(t){var i;return i=$.isPlainObject(t)?t.title||e.getName(t.id):e.getName(t),i||"Newsletter"},getNewsletterId:function(e){return $.isPlainObject(e)?e.id||"":e||""},getSelectedNewsletters:function(e){var t;return e&&this.selectedCache?this.selectedCache:(t=[],this.dom.inputCheckboxes.filter(":checked").each(function(){t.push($(this).val())}),this.dom.inputNlId.length&&t.push(this.dom.inputNlId.val()),this.selectedCache=t,t)}}}return t});
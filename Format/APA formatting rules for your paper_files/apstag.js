/* amazon-dtb-javascript-api - v1.0.0 - 2017-09-12 11:43:58 PM */"use strict";function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}var _extends=Object.assign||function(a){var b,c,d;for(b=1;b<arguments.length;b++){c=arguments[b];for(d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a};!function(){function a(a){return Object.prototype.hasOwnProperty.call(window,a)}var b=function(){var b=!1;return a("apstag")&&window.apstag.hasOwnProperty("debug")&&(b=!0),b}();b||!function(){function b(b){var c,d=La.debugGlobal;return a(d)&&window[d].hasOwnProperty(b)&&(c=window[d][b]),c}function c(){var a=La.defaultAaxHost,c=La.debugGlobal;return b("host")&&(a=window[c].host),a}function d(){try{return window.top!==window.self?encodeURIComponent(document.referrer):""}catch(a){return encodeURIComponent(document.documentURI)}}function e(){var a,b;try{try{b=window.top.document.referrer}catch(c){b=window.document.referrer}a=encodeURIComponent(b)}catch(c){}return a}function f(){var a,c,e=La.debugGlobal;if(b("url"))return a=window[e].url,encodeURIComponent(a);c=encodeURIComponent(document.documentURI);try{c=encodeURIComponent(window.top.location.href),c&&"undefined"!==c||(c=d())}catch(f){c=d()}return c}function g(a){a&&((new Image).src=a)}function h(){return""+La.protocol+c()+La.pixelPath}function i(a){return encodeURIComponent(JSON.stringify(a))}function j(a){Ma&&window.localStorage.setItem(La.debugLocalStorageKey,a)}function k(a){Ma&&window.localStorage.setItem(La.debugConsoleLocalStorageKey,a)}function l(a){a.ts=Date.now(),Ja({type:"LOG_EVENT",event:a})}function m(a){function b(a){if(!Ha.cmpFired){Ja({type:"CMP_FIRED"});var b=document.createElement("iframe");b.style.display="none",b.src=a,document.body.appendChild(b)}}document.readyState&&"loading"===document.readyState?document.addEventListener?document.addEventListener("DOMContentLoaded",function(){b(a)},!1):document.attachEvent&&document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&b(a)}):b(a)}function n(a){r(a)}function o(a){try{a&&a.cmp&&""!==a.cmp&&"undefined"!=typeof a.cmp?m(a.cmp):a&&a.cmpjs&&""!==a.cmpjs&&"undefined"!=typeof a.cmpjs&&window.setTimeout(function(){n(a.cmpjs)},La.cmpjsDelay)}catch(b){}}function p(a){if(!a)return!1;try{var b=~~Number(a);if(b>La.minTimeout)return b}catch(c){return!1}return!1}function q(a,b,c){try{b&&"function"==typeof b&&(a.readyState?a.onreadystatechange=function(){("loaded"===a.readyState||"complete"===a.readyState)&&(a.onreadystatechange=null,b.apply(null,c))}:a.onload=function(){b.apply(null,c)})}catch(d){}}function r(a,b,c){var d,e;return c||(c=document),!a&&b&&"function"==typeof b?void b(!0):(d=c.getElementsByTagName("script")[0],e=c.createElement("script"),e.type="text/javascript",e.async=!0,e.src=a,b&&q(e,b),void d.parentNode.insertBefore(e,d))}function s(a){var b=t(a);g(b)}function t(a){return Ha.config.isSelfServPub?h()+'PH/{"c":"dtb","src":"600","pubid":"'+Ha.config.pubID+'","bla":"'+a+'","m":"DV"}\'':h()+'PH/{"c":"dtb","src":"'+Ha.config.pubID+'","bla":"'+a+'","m":"DV"}\''}function u(a){var b,c=parseInt(a,10);if(!isNaN(c)){if(0===c)return!0;if(100===c)return!1;if(b=100*Math.random(),c>=b)return!1}return!0}function v(a){var b,c,d=a.lsr||La.latencySamplingRate;u(d)||(b=Ha.AAXReqs.filter(function(b){return b.bidReqID===a.cb})[0],c=b.resTs-b.rqTs,s(c))}function w(a){return document.cookie.split("; ").reduce(function(b,c){var d=c.split("=");return d[0]===a?d[1]:b},"")}function x(a){var b,c="setCookies";a[c]&&(b=Object.keys(a[c]),b.forEach(function(b){document.cookie=b+"="+a[c][b]}))}function y(a){a.hasOwnProperty("cb")&&Ja({type:"RECORD_AAX_RESPONSE_TS",bidReqID:a.cb,ts:Date.now()}),Ka.addTimer("br"),Ka.set("brs",a.punt?"0":"1"),a.hasOwnProperty("rm")&&Ka.schedule(a.to,a.id),H()&&na(a)}function z(a){o(a),v(a),x(a)}function A(a,b){var c=!1,d=null,e=function(b){if(!c){try{a(b),d&&clearTimeout(d)}catch(e){}c=!0}},f=p(b);return d=window.setTimeout(e.bind(null,!0),f||La.defaultTimeout),e.bind(null,!1)}function B(){var a=Math.round(1e9*Math.random());return""+a+Date.now()}function C(){var a,b;try{return a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,b=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,a+"x"+b}catch(c){}return"x"}function D(a){var b=a.map(function(a){if(a.hasOwnProperty("mediaType")&&"video"===a.mediaType)return{id:a.slotID,mt:La.mediaTypes.video};if(a.hasOwnProperty("sizes")){var b={sd:a.slotID,s:a.sizes.filter(function(a){return a instanceof Array}).map(function(a){return a.join("x")})};return a.hasOwnProperty("slotName")&&a.slotName!==a.slotID&&(b.sn=a.slotName),b}return _extends({},a,{id:"error"})}).filter(function(a){return"error"!==a.id});return i(b)}function E(a,d){var g,h,j=c(),k=La.protocol,l=La.dtbPath,m=Ha.config.pubID,n=La.pageloadID,o=f(),p=e(),q=B(),r=C(),s=La.libraryVersion,t=La.debugGlobal,u=w(La.firstPartyCookieKey);return Ja({type:"RECORD_AAX_REQUSET",data:{bidConfig:a,timeout:d,bidReqID:q,ws:r,url:o,rqTs:Date.now()}}),g=Ha.config.isSelfServPub?"src=600&pubid="+m+"&u="+o+"&pid="+n+"&cb="+q+"&ws="+r+"&v="+s+"&t="+d:"src="+m+"&u="+o+"&pid="+n+"&cb="+q+"&ws="+r+"&v="+s+"&t="+d,a.hasOwnProperty("slots")&&(g+="&slots="+D(a.slots)),Ha.config.hasOwnProperty("params")&&(g+="&pj="+i(Ha.config.params)),u&&(g+="&ck="+u),b("bidParams")&&Object.keys(window[t].bidParams).forEach(function(a){g+="&"+a+"="+window[t].bidParams[a]}),p&&""!==p&&(g+="&pr="+p),h=""+k+j+l+"/bid?"+g}function F(){Ha&&Ha.hasOwnProperty("Q")&&Ha.Q.forEach(function(a){"i"===a[0]?window.apstag.init.apply(null,a[1]):window.apstag.fetchBids.apply(null,a[1])})}function G(a){return Ja({type:"SET_CONFIG",config:a}),"success"}function H(){return Ha.hasOwnProperty("config")&&Ha.config.hasOwnProperty("adServer")&&"googletag"===Ha.config.adServer}function I(){return"undefined"!=typeof googletag&&googletag.hasOwnProperty("apiReady")&&googletag.apiReady===!0}function J(){return"undefined"!=typeof googletag?"undefined"!=typeof googletag.cmd:!1}function K(b){var c=b.slotID;b.hasOwnProperty("mediaType")||a("googletag")&&J()&&(I()?L(c)&&X(b):googletag.cmd.push(function(){K(b)}))}function L(a){var b;try{b=S().filter(function(b){return b.getSlotElementId()===a})[0]}catch(c){}return b}function M(a){var b,c=La.displayTargetingKeys;try{I()&&(b=L(a),c.forEach(function(a){return b.setTargeting(a,"")}))}catch(d){}}function N(a){var b,c;try{c=Ha.slotBids,Object.keys(c).forEach(function(d){d===a&&c[d].forEach(function(a){a.bidState===La.bidStates.set&&(b=a.amzniid)})})}catch(d){}return b}function O(a){try{if(Ha.slotBids.hasOwnProperty(a)){var b=Ha.slotBids[a].filter(function(a){return a.bidState===La.bidStates.set})[0];b&&b.bidState===La.bidStates.set&&Ja({type:"BID_STATE_CHANGE",slotID:a,bidID:N(a),bidState:La.bidStates.exposed})}}catch(c){}}function P(a,b){var c=decodeURIComponent(a).split("?")[0].split("#")[0],d=decodeURIComponent(b).split("?")[0].split("#")[0];return c===d}function Q(a,b){return a.indexOf(b)>-1}function R(a,b){return a.map(function(a){return Q(b,a)}).filter(function(a){return a}).length===a.length}function S(){var a=[];try{a=googletag.pubads().getSlots()}catch(b){}return a}function T(){var a={};try{Object.keys(Ha.slotBids).forEach(function(b){var c,d=Ha.slotBids[b];d.filter(function(a){return a.bidState===La.bidStates.set}).length>0||(c=d.filter(function(a){return Date.now()-Ha.AAXReqs.filter(function(b){return b.bidReqID===a.bidReqID})[0].rqTs<24e4}).filter(function(a){return P(f(),Ha.AAXReqs.filter(function(b){return b.bidReqID===a.bidReqID})[0].url)}).filter(function(a){return a.bidState!==La.bidStates.rendered}),c.length>0&&(a[b]=c.map(function(a){var b=Ha.AAXReqs.filter(function(b){return b.bidReqID===a.bidReqID})[0].rqTs;return _extends({},a,{rqTs:b})}).reduce(function(a,b){return a.rqTs>b.rqTs?a:b})))})}catch(b){}return a}function U(a){var b,c;try{c=Ha.slotBids,Object.keys(c).forEach(function(d){c[d].forEach(function(c){c.amzniid===a&&(b=c)})})}catch(d){}return b}function V(a){var b={};return a.slots.forEach(function(a){"video"===!a.mediaType?b[a.slotID]=a:(a.slotID.indexOf("rsv-")>=0&&(a={slotID:a.slotID.substring(4),r_amznbid:a.amznbid,r_amzniid:a.amzniid,r_amznp:a.amznp,mediaType:"video"}),b[a.slotID]?b[a.slotID]=_extends({},b[a.slotID],a):b[a.slotID]=a)}),Object.keys(b).map(function(a){return b[a]})}function W(a){var b,c=V(a),d=["host","ev","cb","cmp"];try{b=c.map(function(b){var c={amznsz:b.size,bidState:La.bidStates["new"]};return d.forEach(function(b){var d,e;a.hasOwnProperty(b)&&(d=a[b],e=b,"cb"===b&&(e="bidReqID"),c[e]=d)}),_extends({},b,c)})}catch(e){}return b}function X(a){try{var b,c=a.slotID,d=a.amzniid,e=Da("display");b=L(c),b&&(Object.keys(a).filter(function(a){return Q(e,a)}).forEach(function(c){return b.setTargeting(c,a[c])}),Ja({type:"BID_STATE_CHANGE",slotID:c,bidID:d,bidState:La.bidStates.set}))}catch(f){}}function Y(a){var b=T();a.forEach(function(a){b[a]&&K(b[a])})}function Z(){var a=T();Object.keys(a).forEach(function(b){K(a[b])})}function $(a){try{a?Y(a):Z(),Ha.DFP.slotRenderEndedSet||(googletag.cmd.push(function(){googletag.pubads().addEventListener("slotRenderEnded",function(a){M(a.slot.getSlotElementId()),O(a.slot.getSlotElementId())})}),Ja({type:"DFP_SLOT_RENDER_ENDED_SET"}))}catch(b){}}function _(a){var b,c="?b="+a.bidID+"&pp="+a.pp+"&rnd="+B()+"&p="+a.amznp+"&crid="+a.crID,d=""+a.host+La.dtbPath+"/imp";return b="1"===a.fif?d+"j"+c:d+"i"+c}function aa(a){var b=a.doc.createElement("iframe");return b.frameBorder=0,b.marginHeight=0,b.marginWidth=0,b.topMargin=0,b.leftMargin=0,b.scrolling="no",b.allowTransparency=!0,b.width=a.sizes[0]+"px",b.height=a.sizes[1]+"px",b}function ba(a){var b=aa(a);b.id="apstag-f-iframe-"+B(),b.srcdoc=a.html,a.doc.body.appendChild(b)}function ca(a,b){var c,d=aa(a);d.id=a.adID,d.sandbox="allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation",Na?(c='<body style="background-color: #FF9900;">'+(a.sizes[1]>50?"<h3>apstag Test Creative</h3>":"")+"<h4>amzniid - "+a.bidID+" | amznbid: "+a.pp+" | size: "+a.sizes.join("x")+"</h4></body>",d.src="javascript:'"+c+"'"):d.src=_(a),a.doc.body.appendChild(d),b&&q(a.doc.getElementById(a.adID),function(){return b(a.doc,a.bidID,d)})}function da(b,d,e){var f;a("amzncsm")?f=window.amzncsm:b.defaultView.hasOwnProperty("amzncsm")&&(f=b.defaultView.amzncsm),f&&(f.host=c(),f.rmD(e,d,b.defaultView,b,Ha.config.pubID))}function ea(a){var b=a.map(ma),c={};return Object.keys(Ha.slotBids).forEach(function(a){var d=Ha.slotBids[a].filter(function(a){return a.bidState===La.bidStates["new"]})[0];d&&Q(b,a)&&(c[a]=d,Ja({type:"BID_STATE_CHANGE",slotID:a,bidID:d.amzniid,bidState:La.bidStates.exposed}))}),c}function fa(a,b){var c="0x0";return{slotID:a,amzniid:"",amznbid:b,amznp:b,amznsz:c,size:c}}function ga(a,b,c){var d=b.slots.filter(ua).map(ma),e=a.map(ma),f=[];return f=c?d.map(function(a){return fa(a,La.slotStates.bidInFlight)}):d.reduce(function(a,b){return Q(e,b)||a.push(fa(b,La.slotStates.noBid)),a},[]),a.concat(f)}function ha(a,b){return function(c){var d=ea(b.slots),e=Object.keys(d),f=[];e.forEach(function(a){var b,c,e;d.hasOwnProperty(a)&&(b=d[a],b.hasOwnProperty("amznp")||(b.amznp=""),c={amzniid:b.amzniid,amznbid:b.amznbid,amznp:b.amznp,slotID:a},b.hasOwnProperty("size")&&(c.size=b.size,c.amznsz=b.amznsz),"video"===b.mediaType&&(c.mediaType="video",e="",b.amznbid?e+="&amzniid="+b.amzniid+"&amznbid="+b.amznbid+"&amznp="+b.amznp:(c.amznbid="",c.amzniid=""),b.r_amznbid?(c.r_amznbid=b.r_amznbid,c.r_amzniid=b.r_amzniid,c.r_amznp=b.r_amznp,e+="&r_amzniid="+b.r_amzniid+"&r_amznbid="+b.r_amznbid+"&r_amznp="+b.r_amznp):(c.r_amznbid="",c.r_amzniid="",c.r_amznp=""),c.qsParams=e,c.encodedQsParams=encodeURIComponent(e)),f.push(c))}),H()&&(f=ga(f,b,c)),a(f)}}function ia(a,b){try{var c;c=a.defaultView&&a.defaultView.frameElement?a.defaultView.frameElement:window.frameElement,c.width=b[0],c.height=b[1]}catch(d){}}function ja(a){return a[0]+"x"+a[1]}function ka(a){var b,c;return 1===a.length?b=ja(a[0]):(c=Math.floor(a.length*Math.random()),b=ja(a[c])),b}function la(a,d){var e,g=c(),h=f(),i=B(),j=C(),k=b("testBidTimeout")||200;Ja({type:"RECORD_AAX_REQUSET",data:{bidConfig:a,timeout:k,bidReqID:i,ws:j,url:h,rqTs:Date.now()}}),e=a.slots.map(function(a){var b,c={slotID:a.slotID,amzniid:La.mockBid.amzniid+"-"+B(),amznbid:La.mockBid.amznbid,amznp:La.mockBid.amznp,crid:La.mockBid.crid+"-"+B()};return a.hasOwnProperty("sizes")?(b=ka(a.sizes),c.size=b,c.amznsz=b):"video"===a.mediaType&&(c.mediaType="video",c.amznbid="v_"+c.amznbid),c}),window.setTimeout(function(){window.apstag.bids({slots:e,host:g,status:"ok",cb:i}),d(!0)},k)}function ma(a){return a.slotID}function na(a){var b,c,d,e=Ha.AAXReqs.filter(function(b){return b.bidReqID===a.cb})[0];e&&e.bidConfig&&e.bidConfig.slots&&(b=e.bidConfig.slots.filter(ua).map(function(a){return a.slotID}),c=a.hasOwnProperty("slots")?a.slots.map(function(a){return a.slotID}):[],d=b.filter(function(a){return!Q(c,a)}),Ja({type:"NO_BID_ON_DFP_SLOTS",slotIDs:d}),I()?qa():J()&&googletag.cmd.push(function(){qa()}))}function oa(a){return Q(Ha.AAXReqs.filter(function(a){return!a.resTs}).map(function(a){return a.bidConfig.slots}).reduce(function(a,b){return a.concat(b)},[]).map(ma),a)}function pa(a){var b=a.getTargeting("amznbid");return b.length>0&&b[0].length>2}function qa(){H()&&(I()&&"1"===googletag.pubads().getTargeting("amznbid")[0]&&sa(),S().forEach(function(a){!Q(Ha.DFP.noBidSlotIDs,a.getSlotElementId())||oa(a.getSlotElementId())||pa(a)||"2"===a.getTargeting("amznbid")[0]||ra(a,"noBid")}))}function ra(a,b){La.slotStateKeys.forEach(function(c){return a.setTargeting(c,La.slotStates[b])})}function sa(){La.slotStateKeys.forEach(function(a){return googletag.pubads().clearTargeting(a)})}function ta(){H()&&(I()?ra(googletag.pubads(),"noRequest"):J()&&(googletag.cmd=[function(){ra(googletag.pubads(),"noRequest")}].concat(_toConsumableArray(googletag.cmd))))}function ua(a){return"video"!==a.mediaType}function va(a){H()&&J()&&(Ja({type:"REQUESTED_BID_FOR_DFP_SLOTS",slotIDs:a}),googletag.cmd.push(function(){var b=S();"0"===googletag.pubads().getTargeting("amznbid")[0]&&sa(),R(a,b.map(function(a){return a.getSlotElementId()}))?b.forEach(function(b){Q(a,b.getSlotElementId())&&!pa(b)&&ra(b,"bidInFlight")}):googletag.cmd.push(function(){ra(googletag.pubads(),"bidInFlight")})}))}function wa(a){switch(a){case"getLog":return Ha.eventLog;case"getState":return Ha;case"enable":return j(!0),"DEBUG MODE ENABLED";case"disable":return j(!1),"DEBUG MODE DISABLED";case"enableConsole":return k(!0),"Debug console enabled";case"disableConsole":return k(!1),"Debug console disabled";default:return"unknown debug argument"}}function xa(a,b){var c,d,e,f,g,h,i,j=b||a.amzniid,k=U(j),l=k.size.split("x").map(function(a){return parseInt(a,10)});return 1===arguments.length?void ba({doc:k.doc,sizes:l,html:a.html}):void(k&&(Ja({type:"BID_STATE_CHANGE",slotID:k.slotID,bidID:b,bidState:La.bidStates.rendered}),Ka.addTimer("imp"),c=k.amznbid,d=k.host,e="amznad"+Math.round(1e6*Math.random()),f=k.amznp,g=k.crid?k.crid:"",h={bidID:b,doc:a,pp:c,host:d,adID:e,sizes:l,amznp:f,crID:g,fif:!1},"1"===k.fif?(h.fif="1",Ja({type:"STORE_IMPRESSION_DOC_REF",slotID:k.slotID,bidID:b,doc:a}),r(_(h),null,document)):Ha.viewabilityEnabled?(i=a.createElement("script"),i.type="text/javascript",i.async=!0,a.body.appendChild(i),q(i,function(){ca(h,da)}),i.src=La.CSM_JS):ca(h),ia(a,l)))}function ya(a){try{y(a),Ja({type:"UPDATE_SLOT_BIDS",bids:W(a)}),a.hasOwnProperty("ev")&&Ja({type:"SET_VIEWABILITY",viewability:a.ev}),z(a)}catch(b){}}function za(a,b){var c,d,e;try{"function"!=typeof b&&(b=function(){}),d=a.timeout||Ha.config.bidTimeout||La.defaultTimeout,c=A(ha(b,a),d)}catch(f){}va(a.slots.filter(ua).map(ma)),Na?la(a,c):(e=E(a,d),r(e,c))}function Aa(a){try{a.punt=!0,y(a),z(a)}catch(b){}}function Ba(a){Ha.config.hasOwnProperty("adServer")&&H()&&($(a),qa())}function Ca(a,b){var c=G(a);ta(),"success"===c&&"function"==typeof b&&b()}function Da(){var a=arguments.length<=0||void 0===arguments[0]?"display":arguments[0];switch(a){case"display":return La.displayTargetingKeys;case"video":return La.videoTargetingKeys;default:return"unknown targeting type "+a}}function Ea(){var a=new XMLHttpRequest,b="GET",c=La.debugAppHTML;a.open(b,c,!0),a.onreadystatechange=function(){a.readyState===XMLHttpRequest.DONE&&200===a.status&&Fa(a.responseText)},a.send()}function Fa(a){var b=document.createElement("iframe");b.frameBorder=0,b.marginHeight=0,b.marginWidth=0,b.topMargin=0,b.leftMargin=0,b.scrolling="no",b.allowTransparency=!0,b.width="100%;",b.height="200px",b.id="apstag-debug-iframe",b.srcdoc=a,b.style="background: #eaeded; line-height: 1; text-align: center; font-size: 12px; font-family: sans-serif; font-weight: bold; bottom: 0; position: fixed !important;",document.body.appendChild(b)}function Ga(a,b){var c=b;return b=function(){for(var b=arguments.length,d=Array(b),e=0;b>e;e++)d[e]=arguments[e];return l({method:a,args:arguments}),c.apply(void 0,arguments)}}var Ha,Ia,Ja,Ka,La={libraryVersion:"5.4.0",CSM_JS:"//c.amazon-adsystem.com/aax2/csm.js.gz",debugAppHTML:"//c.amazon-adsystem.com/aax2/debugApp.html",defaultTimeout:2e3,protocol:document.location.protocol+"//",debugGlobal:"apstagDEBUG",debugLocalStorageKey:"apstagDebug",defaultAaxHost:"aax.amazon-adsystem.com",dtbPath:"/e/dtb",latencySamplingRate:1,pixelPath:"/x/px/",minTimeout:0,pageloadID:B(),mockBid:{amznbid:"testBid",amzniid:"testImpression",amznp:"testP",crid:"testCrid"},mediaTypes:{video:"v"},displayTargetingKeys:["amznbid","amzniid","amznsz","amznp"],videoTargetingKeys:["amznbid","amzniid","amznp","r_amznbid","r_amzniid","r_amznp"],slotStateKeys:["amznbid","amznp"],bidStates:{"new":"NEW",exposed:"EXPOSED",set:"SET",rendered:"RENDERED"},firstPartyCookieKey:"__apsid",cmpjsDelay:5e3,slotStates:{noRequest:"0",bidInFlight:"1",noBid:"2"}},Ma=function(){return a("localStorage")}(),Na=function(){if(Ma){var a=window.localStorage.getItem(La.debugLocalStorageKey);if("true"===a)return!0}return!1}(),Oa=function(){if(Ma){var a=window.localStorage.getItem(La.debugConsolLocalStorageKey);if("true"===a)return!0}return!1}(),Pa=function(){var a,b,c=arguments.length<=0||void 0===arguments[0]?{AAXReqs:[],DFP:{slots:[],noBidSlotIDs:[]},slotBids:{},config:{},cmpFired:!1,eventLog:[],sdPixels:{},viewabilityEnabled:!1}:arguments[0],d=arguments[1];switch(d.type){case"LOG_EVENT":return _extends({},c,{eventLog:[].concat(_toConsumableArray(c.eventLog),[d.event])});case"SET_CONFIG":return a=_extends({},d.config),a.isSelfServPub=!1,a.pubID&&a.pubID.length>=5&&(a.isSelfServPub=!0),_extends({},c,{config:a});case"SET_Q":return _extends({},c,{Q:d.Q});case"SET_VIEWABILITY":return _extends({},c,{viewabilityEnabled:d.viewability});case"CMP_FIRED":return _extends({},c,{cmpFired:!0});case"ENABLE_DEBUG":return _extends({},c,{debugEnabled:!0});case"DISABLE_DEBUG":return _extends({},c,{debugEnabled:!1});case"RECORD_AAX_REQUSET":return _extends({},c,{AAXReqs:[].concat(_toConsumableArray(c.AAXReqs),[d.data])});case"RECORD_AAX_RESPONSE_TS":return _extends({},c,{AAXReqs:c.AAXReqs.map(function(a){return a.bidReqID===d.bidReqID&&(a.resTs=d.ts),a})});case"UPDATE_SLOT_BIDS":return b={},d.bids.forEach(function(a){c.slotBids.hasOwnProperty(a.slotID)?b[a.slotID]=[].concat(_toConsumableArray(c.slotBids[a.slotID]),[a]):b[a.slotID]=[a]}),_extends({},c,{slotBids:_extends({},c.slotBids,b)});case"SD_PIXEL":return _extends({},c,{sdPixels:_extends({},c.sdPixels,_defineProperty({},d.id,d.json))});case"DFP_SLOT_RENDER_ENDED_SET":return _extends({},c,{DFP:_extends({},c.DFP,{slotRenderEndedSet:!0})});case"BID_STATE_CHANGE":return _extends({},c,{slotBids:_extends({},c.slotBids,_defineProperty({},d.slotID,c.slotBids[d.slotID].map(function(a){return a.amzniid===d.bidID?_extends({},a,{bidState:d.bidState}):a})))});case"STORE_IMPRESSION_DOC_REF":return _extends({},c,{slotBids:_extends({},c.slotBids,_defineProperty({},d.slotID,c.slotBids[d.slotID].map(function(a){return a.amzniid===d.bidID?_extends({},a,{doc:d.doc}):a})))});case"NO_BID_ON_DFP_SLOTS":return _extends({},c,{DFP:_extends({},c.DFP,{noBidSlotIDs:c.DFP.noBidSlotIDs.concat(d.slotIDs)})});case"REQUESTED_BID_FOR_DFP_SLOTS":return _extends({},c,{DFP:_extends({},c.DFP,{noBidSlotIDs:c.DFP.noBidSlotIDs.filter(function(a){return Q(d.slotIDs,a)})})});default:return c}},Qa=Na&&a("__REDUX_DEVTOOLS_EXTENSION__")?!0:null;Qa&&(Ia=window.__REDUX_DEVTOOLS_EXTENSION__(Pa),Ia.subscribe(function(){Ha=Ia.getState()})),Ja=function(a){Qa?Ia.dispatch(a):Ha=Pa(Ha,a)},Ka=function(){var a={},b=Date.now(),c=0,d=function(){var a,b=decodeURIComponent(f());return a=b.indexOf("://")>-1?b.split("/")[2]:b.split("/")[0],a=a.split(":")[0]},e=function(c,d){d||(d=Date.now()),a[c]=d-b},j=function(b,c){a[b]=c},k=function(e,f){e||(e=5e3),f||(f="PH"),f+="/",setTimeout(function(){a.i=c,a.t0=b,a.site=d();var e=h()+f+i(a);g(e),a={},b=Date.now(),c++},e)};return{addTimer:e,set:j,schedule:k}}(),Ka.addTimer("tlt");try{Object.prototype.hasOwnProperty.call(window,"apstag")&&Object.prototype.hasOwnProperty.call(window.apstag,"_Q")&&window.apstag._Q.length>0&&Ja({type:"SET_Q",Q:window.apstag._Q})}catch(Ra){}window.apstag=function(){var a={punt:Aa,init:Ca,debug:wa,targetingKeys:Da,fetchBids:za,setDisplayBids:Ba,renderImp:xa,bids:ya};return Oa&&(Object.keys(a).forEach(function(b){a[b]=Ga(b,a[b])}),Ea()),a}(),function(){F()}()}()}();